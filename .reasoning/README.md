# Reasoning Layer - AI Context

This directory contains real-time reasoning context for AI agents.

## For AI Assistants

Read `current-context.json` to understand:
- Current user intent and goals
- Active tasks and pending actions
- Recent architectural decisions
- Project hot spots and blockers

**Usage example (Python):**
```python
import json
with open('.reasoning/current-context.json') as f:
    context = json.load(f)
    print(f"Current goal: {context['ai_summary']['current_intent']}")
    print(f"Pending actions: {context['ai_summary']['pending_actions']}")
```

**Usage example (TypeScript):**
```typescript
import * as fs from 'fs';
const context = JSON.parse(fs.readFileSync('.reasoning/current-context.json', 'utf8'));
console.log(`Active goals: ${context.ai_summary.active_goals.join(', ')}`);
```

**Usage example (JavaScript - Node.js):**
```javascript
const fs = require('fs');
const context = JSON.parse(fs.readFileSync('.reasoning/current-context.json', 'utf8'));
console.log('Current Intent:', context.ai_summary.current_intent);
console.log('Pending Actions:', context.ai_summary.pending_actions);
```

## Structure

- `current-context.json` - Real-time project context (updated on every code change)
- `logs/activity.jsonl` - Structured activity log (JSON Lines format)
- `sessions/` - Historical reasoning graphs (in workspace root)

## Current Context Schema

```typescript
interface CurrentContext {
  timestamp: string;              // ISO 8601 timestamp
  workspace: string;              // Workspace name
  current_graph: {
    id: string;
    title: string;
    nodes: ReasoningNode[];       // Complete graph with all nodes
    edges: ReasoningEdge[];
    stats: {
      total_nodes: number;
      goals: number;
      actions: number;
      decisions: number;
      contexts: number;
      completed: number;
      pending: number;
    };
  } | null;
  project_state: {
    files_tracked: number;
    graphs_generated: number;
    last_activity: string;
    hot_files: Array<{file: string, modifications: number}>;
  };
  ai_summary: {
    current_intent: string;       // Main goal/purpose
    active_goals: string[];       // Running or pending goals
    pending_actions: string[];    // Actions ready to implement
    recent_decisions: string[];   // Last 5 architectural decisions
    blockers: string[];           // Failed tasks needing attention
    suggestions: string[];        // Contextual recommendations
  };
}
```

## File Watching

Monitor `current-context.json` for changes to react in real-time:

**Node.js:**
```javascript
const fs = require('fs');
fs.watch('.reasoning/current-context.json', (eventType) => {
  if (eventType === 'change') {
    const newContext = JSON.parse(fs.readFileSync('.reasoning/current-context.json'));
    // Adapt AI behavior based on new context
    console.log('Context updated:', newContext.ai_summary.current_intent);
  }
});
```

**Python:**
```python
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler
import json

class ContextHandler(FileSystemEventHandler):
    def on_modified(self, event):
        if event.src_path.endswith('current-context.json'):
            with open(event.src_path) as f:
                context = json.load(f)
                print("Context updated:", context['ai_summary']['current_intent'])

observer = Observer()
observer.schedule(ContextHandler(), '.reasoning', recursive=False)
observer.start()
```

## Activity Logs (JSON Lines)

The `logs/activity.jsonl` file contains structured logs in JSON Lines format:

```jsonl
{"timestamp":"2025-10-23T16:00:00Z","level":"INFO","component":"ClaudeBridge","message":"Graph generated","action":"GraphGenerated","duration":1.2}
{"timestamp":"2025-10-23T16:00:01Z","level":"SUCCESS","component":"Persistence","message":"Graph saved","action":"GraphSaved"}
```

Each line is a valid JSON object that can be parsed independently.

## Use Cases

1. **Context-Aware Code Suggestions**: Read current goals to tailor recommendations
2. **Automated Task Execution**: Parse pending actions and execute them programmatically
3. **Project Analytics**: Track completion rates, hot spots, and blockers over time
4. **AI-Driven Development**: Let AI agents make decisions based on project state
5. **Integration with CI/CD**: Use reasoning graphs to optimize build and test strategies

## Updates

This file is automatically updated by the Reasoning Layer extension on every code change.
No manual intervention required.

---

Generated by Reasoning Layer v1.1.0
